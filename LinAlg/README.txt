This is a (Template) Haskell translation of the SCP2008 code.  Since we're
using TH anyways, a few more extensions are used as well, to make the code
as nice as possible.
